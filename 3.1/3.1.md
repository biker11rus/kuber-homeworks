# Домашнее задание к занятию 3.1 "Компоненты Kubernetes "


### Задание. Необходимо определить требуемые ресурсы

Известно, что проекту нужны база данных и система кеширования. Приложение состоит из бекенда и фронтенда.    
Опишите, какие ресурсы требуются при условии, что:   

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения. 
2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
3. Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий. 
5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

**План расчёта**

1. Сделайте расчет всех необходимых ресурсов.
1. Спланируйте количество рабочих нод, которые справятся с такой нагрузкой. 
1. Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды. 
1. Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные. 
1. В результате должно быть указано количество нод и их параметры.

## *Ответ*

**Расчет ресурсов рабочих нод**
||CPU|RAM GB|Кол-во копий|Всего CPU|Всего RAM GB|
|:-:|:-:|:-:|:-:|:-:|:-:|
|База|1|4|3|3|12|
|Кэш|1|4|3|3|12|
|Фронт|0.2|0.05|5|1|0.25|
|Бекенд|1|0.6|10|10|6
|ИТОГО||||17|30,25|  

Необходимо добавить ресурсы для служебной нагрузки каждой рабочей ноды + 1 CPU и  2 GB RAM  

Произведем расчеты на 3 и 4 рабочие ноды, так как на 2 ноды  расчет производить некорректно, с учетом минимального количества копий (3) и условия отказоустойчивости.  

На 3 рабочие ноды:  
Минимальное кол-во CPU: 17(Рабочие ресурсы) + 3 (служебные ресурсы) = 20  
Минимальное кол-во RAM: 30.25(Рабочие ресурсы) +  6 (служебные ресурсы) = 36,25  
3 ноды по 8 CPU (всего 24) и 14 GB RAM (всего 42)  
Добавим еще 1 ноду с такими же параметрами, на случай выхода из строя одной  
В итоге: 4 ноды по 8 CPU (всего 32) и 14 GB RAM (всего 56)

На 4 рабочие ноды:  
Минимальное кол-во CPU: 17(Рабочие ресурсы) + 4 (служебные ресурсы) = 21  
Минимальное кол-во RAM: 30.25(Рабочие ресурсы) +  8 (служебные ресурсы) = 38,25  
4 ноды по 6 CPU (всего 24) и 10 GB RAM (всего 40)  
Добавим еще 1 ноду с такими же параметрами, на случай выхода из строя одной  
В итоге: 5 нод по 6 CPU (всего 30) и 10 GB RAM (всего 50)

В техническом задании не указаны требования по дисковой ёмкости, предположим что по 100 GB на каждую ноду  

Оптимальнее взять 5 рабочих нод по 6 CPU (всего 30), 10 GB RAM (всего 50) и 100 GB Дисковой ёмкости (всего 500)  

**Расчет ресурсов для Control plane**  
Для организации отказоустойчивости количество нод для Control plane должно быть нечетным и больше 1, соответственно - минимум 3.
Требования каждой ноды Control plane 2 CPU и 2 GB RAM
В техническом задании не указаны требования по дисковой ёмкости, предположим что по 50 GB на каждую ноду

**Итоговый расчет**  
5 нод по 6 CPU (всего 30), 10 GB RAM (всего 50) 100 GB диск (всего 500) для Рабочих нод   
3 ноды по 2 CPU (всего 6), GB RAM (всего 6) и 50 GB Диск (всего 150) для Control plane  




